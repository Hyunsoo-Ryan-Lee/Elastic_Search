(window["visTypeTable_bundle_jsonpfunction"]=window["visTypeTable_bundle_jsonpfunction"]||[]).push([[4],{25:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TableOptions}));var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5);var react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8);var _elastic_eui__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__);const TableOptionsComponent=Object(react__WEBPACK_IMPORTED_MODULE_0__["lazy"])(()=>__webpack_require__.e(5).then(__webpack_require__.bind(null,31)));const TableOptions=props=>react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__["Suspense"],{fallback:react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_elastic_eui__WEBPACK_IMPORTED_MODULE_1__["EuiLoadingSpinner"],null)},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(TableOptionsComponent,props))},26:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return toExpressionAst}));var _expressions_public__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14);var _expressions_public__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_expressions_public__WEBPACK_IMPORTED_MODULE_0__);var _visualizations_public__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(9);var _visualizations_public__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_visualizations_public__WEBPACK_IMPORTED_MODULE_1__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}const buildTableVisConfig=(schemas,visParams)=>{const metrics=schemas.metric;const buckets=schemas.bucket||[];const visConfig={dimensions:{metrics:metrics,buckets:buckets,splitRow:schemas.split_row,splitColumn:schemas.split_column}};if(visParams.showPartialRows&&!visParams.showMetricsAtAllLevels){const metricsPerBucket=metrics.length/buckets.length;visConfig.dimensions.metrics.splice(0,metricsPerBucket*buckets.length-metricsPerBucket)}return visConfig};const toExpressionAst=(vis,params)=>{const esaggs=Object(_expressions_public__WEBPACK_IMPORTED_MODULE_0__["buildExpressionFunction"])("esaggs",{index:Object(_expressions_public__WEBPACK_IMPORTED_MODULE_0__["buildExpression"])([Object(_expressions_public__WEBPACK_IMPORTED_MODULE_0__["buildExpressionFunction"])("indexPatternLoad",{id:vis.data.indexPattern.id})]),metricsAtAllLevels:vis.isHierarchical(),partialRows:vis.params.showPartialRows,aggs:vis.data.aggs.aggs.map(agg=>Object(_expressions_public__WEBPACK_IMPORTED_MODULE_0__["buildExpression"])(agg.toExpressionAst()))});const schemas=Object(_visualizations_public__WEBPACK_IMPORTED_MODULE_1__["getVisSchemas"])(vis,params);const visConfig=_objectSpread(_objectSpread(_objectSpread({},vis.params),buildTableVisConfig(schemas,vis.params)),{},{title:vis.title});const table=Object(_expressions_public__WEBPACK_IMPORTED_MODULE_0__["buildExpressionFunction"])("kibana_table",{visConfig:JSON.stringify(visConfig)});const ast=Object(_expressions_public__WEBPACK_IMPORTED_MODULE_0__["buildExpression"])([esaggs,table]);return ast.toAst()}},57:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"registerTableVis",(function(){return registerTableVis}));var external_kbnSharedDeps_KbnI18n_=__webpack_require__(6);var services=__webpack_require__(0);function tableVisResponseHandler(input,dimensions){let table;let tables=[];let direction;const split=dimensions.splitColumn||dimensions.splitRow;if(split){tables=[];direction=dimensions.splitRow?"row":"column";const splitColumnIndex=split[0].accessor;const splitColumnFormatter=Object(services["a"])().deserialize(split[0].format);const splitColumn=input.columns[splitColumnIndex];const splitMap={};let splitIndex=0;input.rows.forEach((row,rowIndex)=>{const splitValue=row[splitColumn.id];if(!splitMap.hasOwnProperty(splitValue)){splitMap[splitValue]=splitIndex++;const tableGroup={title:"".concat(splitColumnFormatter.convert(splitValue),": ").concat(splitColumn.name),name:splitColumn.name,key:splitValue,column:splitColumnIndex,row:rowIndex,table:input,tables:[]};tableGroup.tables.push({columns:input.columns,rows:[]});tables.push(tableGroup)}const tableIndex=splitMap[splitValue];tables[tableIndex].tables[0].rows.push(row)})}else{table={columns:input.columns,rows:input.rows}}return{direction:direction,table:table,tables:tables}}const createTableVisFn=()=>({name:"kibana_table",type:"render",inputTypes:["datatable"],help:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTable.function.help",{defaultMessage:"Table visualization"}),args:{visConfig:{types:["string","null"],default:'"{}"',help:""}},fn(input,args){const visConfig=args.visConfig&&JSON.parse(args.visConfig);const convertedData=tableVisResponseHandler(input,visConfig.dimensions);return{type:"render",as:"table_vis",value:{visData:convertedData,visType:"table",visConfig:visConfig}}}});var external_kbnSharedDeps_React_=__webpack_require__(5);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_ReactDom_=__webpack_require__(19);var public_=__webpack_require__(9);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const TableVisualizationComponent=Object(external_kbnSharedDeps_React_["lazy"])(()=>__webpack_require__.e(2).then(__webpack_require__.bind(null,55)));const getTableVisRenderer=core=>({name:"table_vis",reuseDomNode:true,render:function(){var _render2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(domNode,{visData:visData,visConfig:visConfig},handlers){var _visData$table;var showNoResult;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:handlers.onDestroy(()=>{Object(external_kbnSharedDeps_ReactDom_["unmountComponentAtNode"])(domNode)});showNoResult=((_visData$table=visData.table)===null||_visData$table===void 0?void 0:_visData$table.rows.length)===0||!visData.table&&visData.tables.length===0;Object(external_kbnSharedDeps_ReactDom_["render"])(external_kbnSharedDeps_React_default.a.createElement(public_["VisualizationContainer"],{"data-test-subj":"tbvChartContainer",handlers:handlers,showNoResult:showNoResult},external_kbnSharedDeps_React_default.a.createElement(TableVisualizationComponent,{core:core,handlers:handlers,visData:visData,visConfig:visConfig})),domNode);case 3:case"end":return _context.stop()}}),_callee)})));function render(_x,_x2,_x3){return _render2.apply(this,arguments)}return render}()});var data_public_=__webpack_require__(10);var visDefaultEditor_public_=__webpack_require__(13);var table_vis_options_lazy=__webpack_require__(25);var to_ast=__webpack_require__(26);const tableVisTypeDefinition={name:"table",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTable.tableVisTitle",{defaultMessage:"Data table"}),icon:"visTable",description:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTable.tableVisDescription",{defaultMessage:"Display data in rows and columns."}),getSupportedTriggers:()=>[public_["VIS_EVENT_TO_TRIGGER"].filter],visConfig:{defaults:{perPage:10,showPartialRows:false,showMetricsAtAllLevels:false,showTotal:false,showToolbar:false,totalFunc:"sum",percentageCol:""}},editorConfig:{optionsTemplate:table_vis_options_lazy["a"],schemas:new visDefaultEditor_public_["Schemas"]([{group:data_public_["AggGroupNames"].Metrics,name:"metric",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTable.tableVisEditorConfig.schemas.metricTitle",{defaultMessage:"Metric"}),aggFilter:["!geo_centroid","!geo_bounds"],aggSettings:{top_hits:{allowStrings:true}},min:1,defaults:[{type:"count",schema:"metric"}]},{group:data_public_["AggGroupNames"].Buckets,name:"bucket",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTable.tableVisEditorConfig.schemas.bucketTitle",{defaultMessage:"Split rows"}),aggFilter:["!filter"]},{group:data_public_["AggGroupNames"].Buckets,name:"split",title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("visTypeTable.tableVisEditorConfig.schemas.splitTitle",{defaultMessage:"Split table"}),min:0,max:1,aggFilter:["!filter"]}])},toExpressionAst:to_ast["a"],hierarchicalData:vis=>vis.params.showPartialRows||vis.params.showMetricsAtAllLevels};function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function register_vis_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function register_vis_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){register_vis_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){register_vis_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}const registerTableVis=function(){var _ref=register_vis_asyncToGenerator(regeneratorRuntime.mark((function _callee(core,{expressions:expressions,visualizations:visualizations},context){var _yield$core$getStartS,_yield$core$getStartS2,coreStart;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return core.getStartServices();case 2:_yield$core$getStartS=_context.sent;_yield$core$getStartS2=_slicedToArray(_yield$core$getStartS,1);coreStart=_yield$core$getStartS2[0];expressions.registerFunction(createTableVisFn);expressions.registerRenderer(getTableVisRenderer(coreStart));visualizations.createBaseVisualization(tableVisTypeDefinition);case 8:case"end":return _context.stop()}}),_callee)})));return function registerTableVis(_x,_x2,_x3){return _ref.apply(this,arguments)}}()}}]);